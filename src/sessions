#sessions
# removing random chr files
rm `ls * | grep "random"`

cd /media/data/brainJuice/coverages/s2
# for coverages
Rscript ~/chip/src/clusterVanilla.R

#files
chip=/media/data/sukhi/rotterdam/uniqueRot/s_2_1.fastq.chipseq.bowtie.SR.mm9.sam.srt.bam.unique
control=/media/data/sukhi/rotterdam/uniqueRot/s_5_1.fastq.chipseq.bowtie.SR.mm9.sam.srt.bam.unique

# use bed differentiator to extend the read start and end pos by 1
Rscript ~/chip/src/bedDifferntiator.R

# bedfile to bigwig
./bedGraphToBigWig ~/chip/projects/rotterdam/vanilla_R/covFile.bedDiff mm9.chrom.bedDiff chip.bw

# login to biocluster
ssh -x sukhdeeps@biocluster.biotec.tu-dresden.de
qlogin -l mem_free=46G

# fetching all files recursively using scp
scp -r sukhdeeps@biocluster.biotec.tu-dresden.de:/home/genom/sukhdeeps/workspace/rotterdam/results/files/bedGraphs/R_vanilla/ .

################################
# FP4 - FindPeaks (/home/genom/sukhdeeps/workspace/rotterdam/results/files/bedGraphs/R_vanilla/trunk)
###
Xmx is very important to set up upper ram limit like 'Xmx10G' to avoid java memory heap problems
###
# bam to bed 
time java -jar jars/conversion_util/ConvertToBed.jar -aligner BAM -input /projects/globalscratch/sukhi/rotterdam/uniqueRot/s_1_1.fastq.chipseq.bowtie.SR.mm9.sam.srt.bam.unique -output javaBowtie/ -noprepend -name javaBow_bed

# sort bedGraphs
java -jar ../jars/fp4/SortFiles.jar bed ../../grub/ *.gz


# using findPeaks
java -Xmx2G -jar ../../trunk/jars/fp4/FindPeaks.jar -input *.gz -aligner bed -output ../wig -dist_type 1 -name example -one_p

# wig2BigWig
~/wigToBigWig -clip example_triangle_standard_chr10.wig.gz ~/mm9.chrom chr10.bw

# findPeaks compare
#test run
time java -jar ../../trunk/jars/fp4/FindPeaks.jar -aligner SAM -input s1_sorted.bam.bam -compare s5_sorted.bam.bam -dist_type 3 \ -one_per -subpeaks .5 -name compare -output . -alpha 0.01 -qualityfilter 10 -log_transform

# real data
time java -jar ../trunk/jars/fp4/FindPeaks.jar -aligner SAM -input /projects/globalscratch/sukhi/rotterdam/uniqueRot/s_8_1.fastq.chipseq.bowtie.SR.mm9.sam.srt.bam.unique -compare /projects/globalscratch/sukhi/rotterdam/uniqueRot/s_5_1.fastq.chipseq.bowtie.SR.mm9.sam.srt.bam.unique -dist_type 3 \ -one_per -subpeaks .5 -name s8 -output s8/ -alpha 0.01 -qualityfilter 10 -log_transform &


##
# UCSC wiggle display
track type="wiggle_0" name="sample_filtered_compare_chr_chr6_duplicates_subpeaks_len_mode_3" description="sample_filtered_compare_chr_chr6_FL:mode_3_dupe_rds_inc" color=50,50,150 yLineMark=0.0 yLineOnOff=on visibility=2 priority=1 autoScale=on maxHeightPixels=40:40:2
